import re\n\nfrom bs4 import BeautifulSoup\n\n\nNOISE_CLASS_ID_SUBSTRINGS = (\"cookie\", \"consent\", \"gdpr\")\n\n\ndef normalize_html_to_text(html: str) -> str:\n    \"\"\"Normalize HTML to a stable text representation to reduce alert noise.\"\"\"\n    soup = BeautifulSoup(html or \"\", \"html.parser\")\n\n    for tag in soup([\"script\", \"style\", \"noscript\"]):\n        tag.decompose()\n\n    for tag_name in [\"nav\", \"header\", \"footer\"]:\n        for tag in soup.find_all(tag_name):\n            tag.decompose()\n\n    for tag in soup.find_all(True):\n        attrs = \" \".join([str(tag.get(\"id\", \"\")), \" \".join(tag.get(\"class\", []) or [])]).lower()\n        if any(s in attrs for s in NOISE_CLASS_ID_SUBSTRINGS):\n            tag.decompose()\n\n    text = soup.get_text(separator=\" \")\n    text = re.sub(r\"\\s+\", \" \", text).strip()\n\n    text = re.sub(r\"\\b\\d{4}-\\d{2}-\\d{2}\\b\", \"<DATE>\", text)\n    text = re.sub(r\"\\b\\d{2}:\\d{2}(:\\d{2})?\\b\", \"<TIME>\", text)\n    return text\n